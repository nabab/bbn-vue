(bbn_resolve)=>{((bbn)=>{let script=document.createElement('script');script.innerHTML=`<div :class="componentClass"
     :style="{zIndex: zIndex}"
>
  <bbn-scroll :scrollable="scrollable"
              @hook:mounted="onScrollMounted"
  >
    <div v-if="!showIcons"
         :class="['bbn-fisheye-dots', 'bbn-overlay', 'bbn-middle', {'bbn-invisible': !ready}]"
         :style="{zIndex: zIndex}"
    >
      <span class="bbn-block bbn-p"
            @click="toggleFloater"
            ref="dots"
        >
          <i class="nf nf-mdi-dots_horizontal bbn-middle"></i>
        </span>
    </div>
    <ul ref="container"
        :class="['bbn-spadded', {'bbn-invisible': !showIcons || !ready}]"
        :style="{zIndex: zIndex}"
    >
      <li v-for="it in items"
          :key="it.index"
          :draggable="!it.fixed"
          @mouseover="mouseover(it.index)"
          @mouseout="mouseout(it.index)"
          @dragstart="dragstart(it.index, $event)"
          @dragend="dragend(it.index, $event)"
      >
        <span class="bbn-iblock bbn-p"
              draggable="false"
              @click="onClick(it.data, it.index)"
        >
          <i :class="it.data.icon"></i>
        </span>
      </li>
    </ul>
  </bbn-scroll>
  <bbn-floater v-if="visibleFloater"
               ref="floater"
               class="bbn-widget"
               :auto-hide="1000"
               @close="visibleFloater = false"
               :scrollable="true"
               width="100%"
               height="100%"
               :left="0"
               :right="0"
               :top="floaterTop"
  >
    <div class="bbn-spadded bbn-fisheye-floater-content">
      <span v-for="it in items"
            :key="it.index"
            :draggable="!it.fixed"
            @dragstart="dragstart(it.index, $event)"
            @dragend="dragend(it.index, $event)"
            class="bbn-w-100 bbn-c bbn-smargin bbn-p"
            @click="onClick(it.data, it.index)"
      >
        <div class="bbn-w-100 bbn-middle">
          <i :class="[it.data.icon, 'bbn-fisheye-floater-icon', 'bbn-box', ' bbn-xxspadded', 'bbn-middle']"></i>
        </div>
        <div class="bbn-w-100 bbn-top-sspace" v-text="it.data[sourceText]"></div>
      </span>
    </div>
  </bbn-floater>
  <div class="bbn-fisheye-bin"
       v-if="visibleBin"
       :style="binPosition"
  >
    <i :class="['nf nf-fa-trash', {'bbn-red': overBin}]"
       @dragenter.prevent="overBin = true"
       @dragover.prevent="() => {}"
       @dragleave="dragleave($event)"
       @drop="drop($event)"
    ></i>
  </div>
  <div class="bbn-fisheye-text"
       v-if="(visibleText > -1) && showIcons"
       v-html="items[visibleText].data[sourceText]"
  ></div>
</div>`;script.setAttribute('id','bbn-tpl-component-fisheye');script.setAttribute('type','text/x-template');document.body.insertAdjacentElement('beforeend',script);let css=document.createElement('link');css.setAttribute('rel',"stylesheet");css.setAttribute('href',bbn.vue.libURL+"dist/js/components/fisheye/fisheye.css");document.head.insertAdjacentElement('beforeend',css);(function(bbn){"use strict";Vue.component('bbn-fisheye',{mixins:[bbn.vue.basicComponent,bbn.vue.resizerComponent,bbn.vue.listComponent],props:{source:{type:Array,default(){return[];}},removable:{type:Boolean,default:false},fixedLeft:{type:Array,default(){return[];}},fixedRight:{type:Array,default(){return[];}},zIndex:{type:Number,default:1},scrollable:{type:Boolean,default:false},mobile:{type:Boolean,default:false}},data(){return{menu:false,widget:false,overBin:false,droppableBin:false,timeout:false,binTimeout:false,visibleBin:false,visibleText:-1,draggedIdx:-1,showIcons:!this.mobile,visibleFloater:false,floaterTop:0};},computed:{items(){let items=[];let i=0;bbn.fn.each(this.fixedLeft,a=>{items.push({data:a,fixed:true,index:i});i++;});bbn.fn.each(this.filteredData,a=>{items.push({data:a.data,fixed:false,index:i});i++;});bbn.fn.each(this.fixedRight,a=>{items.push({data:a,fixed:true,index:i});i++;});return items;},binPosition(){return this.showIcons?'top: 15em':'bottom: calc(-'+bbn.env.height+'px + 5em)';}},methods:{onClick(it){if(it.url){bbn.fn.link(it.url);}
if(it.action&&bbn.fn.isFunction(it.action)){it.action();}
this.visibleFloater=false;},mouseover(idx){if(!bbn.fn.isMobile()&&(this.visibleText!==idx)){clearTimeout(this.timeout);this.visibleText=-1;this.timeout=setTimeout(()=>{this.visibleText=idx;},500);}},mouseout(){clearTimeout(this.timeout);this.visibleText=-1;},dragleave(){setTimeout(()=>{this.overBin=false;},500);},dragstart(idx,e){if(this.removable&&e.dataTransfer){e.dataTransfer.allowedEffect='move';e.dataTransfer.dropEffect='move';this.draggedIdx=idx;this.visibleBin=true;}
else{e.preventDefault();}},dragend(){if(this.removable){this.visibleBin=false;this.draggedIdx=-1;}},drop(e){if(this.items[this.draggedIdx]){e.preventDefault();this.$emit('remove',this.items[this.draggedIdx].data,e);}},checkMeasures(){let ct=this.getRef('container');if(ct&&!this.mobile){this.showIcons=this.lastKnownWidth>=ct.offsetWidth;}},toggleFloater(){if(!this.visibleFloater){this.floaterTop=this.$el.getBoundingClientRect().height;}
this.visibleFloater=!this.visibleFloater;},onScrollMounted(){this.$nextTick(()=>{this.checkMeasures();})}},mounted(){this.setResizeMeasures();this.setContainerMeasures();this.$nextTick(()=>{this.ready=true;this.checkMeasures();})},watch:{source(){this.updateData();},lastKnownWidth(newVal){this.checkMeasures();},items(){if(this.ready){this.$nextTick(()=>{this.checkMeasures();})}}}});})(bbn);if(bbn_resolve){bbn_resolve("ok");}})(bbn);}
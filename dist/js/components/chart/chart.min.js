(bbn_resolve)=>{((bbn)=>{let script_dep=document.createElement('script');script_dep.setAttribute('src',"https://cdn.jsdelivr.net/combine/gh/apexcharts/apexcharts.js@v3.19.2/dist/apexcharts.min.js");script_dep.onload=()=>{let css_dependency;css_dependency=document.createElement('link');css_dependency.setAttribute('rel',"stylesheet");css_dependency.setAttribute('href',"https://cdn.jsdelivr.net/combine/gh/apexcharts/apexcharts.js@v3.19.2/dist/apexcharts.css");document.head.insertAdjacentElement('beforeend',css_dependency);let script=document.createElement('script');script.innerHTML=`<div :class="['bbn-flex-height', componentClass]"
     :style="{
       width: width,
       height: height
     }"
>
  <h4 v-if="title"
      v-html="title"
      class="bbn-middle"
  ></h4>
  <div class="bbn-flex-fill bbn-rel"
       style="width: 100%"
  >
     <div class="bbn-overlay"
          ref="container"
     >
       <div v-if="ready"
            ref="chart"
            class="bbn-chart-widget"
       ></div>
     </div>
  </div>
</div>`;script.setAttribute('id','bbn-tpl-component-chart');script.setAttribute('type','text/x-template');document.body.insertAdjacentElement('beforeend',script);let css=document.createElement('link');css.setAttribute('rel',"stylesheet");css.setAttribute('href',bbn.vue.libURL+"dist/js/components/chart/chart.css");document.head.insertAdjacentElement('beforeend',css);(bbn=>{"use strict";Vue.component('bbn-chart',{mixins:[bbn.vue.basicComponent,bbn.vue.resizerComponent],props:{source:{type:Object},type:{type:String,required:true,default:'line',validator:t=>['line','bar','pie','donut','area','radial'].includes(t)},width:{type:String,default:'100%'},height:{type:String,default:'100%'},theme:{type:String,default(){if(appui&&appui.theme&&appui.themes){let isDark=bbn.fn.getField(appui.themes,'isDark',{value:appui.theme});return!!isDark?'dark':'light';}
return'light';},validator:t=>['light','dark'].includes(t)},title:{type:String},xTitle:{type:String},yTitle:{type:String},points:{type:[Boolean,Number],default:6},pointsLabels:{type:Boolean,default:true},smooth:{type:Boolean,default:false},step:{type:Boolean,default:false},donut:{type:[Boolean,Number],default:false},fill:{type:String,default:'gradient',validator:f=>['gradient','solid'].includes(f)},opacity:{type:[Number,String]},xAxis:{type:Object,default(){return{};}},yAxis:{type:Object,default(){return{};}},grid:{type:Boolean,default:true},xGrid:{type:Boolean,default:true},yGrid:{type:Boolean,default:true},gridColor:{type:String},gridBackground:{type:String},animation:{type:[Boolean,Number],default:800},stacked:{type:Boolean,default:false},barsDistance:{type:Number},horizontal:{type:Boolean,default:false},color:{type:[String,Array],default(){return[bbn.var.colors.webblue,bbn.var.colors.turquoise,bbn.var.colors.orange,bbn.var.colors.red,bbn.var.colors.purple,bbn.var.colors.yellow,bbn.var.colors.pink,bbn.var.colors.brown,bbn.var.colors.grey,bbn.var.colors.navy,bbn.var.colors.olive,bbn.var.colors.pastelorange,bbn.var.colors.cyan,bbn.var.colors.green,bbn.var.colors.black,bbn.var.colors.white]}},labels:{type:Boolean,default:true},xLabels:{type:Boolean,default:true},yLabels:{type:Boolean,default:true},labelsColor:{type:String},xLabelsColor:{type:String},yLabelsColor:{type:String},xLabelsRotate:{type:Number},yLabelsRotate:{type:Number},labelsRender:{type:Function},xLabelsRender:{type:Function},yLabelsRender:{type:Function},labelsOffsetX:{type:Number,default:0},labelsOffsetY:{type:Number,default:0},xLabelsOffsetX:{type:Number,default:0},xLabelsOffsetY:{type:Number,default:0},yLabelsOffsetX:{type:Number,default:0},yLabelsOffsetY:{type:Number,default:0},background:{type:String},max:{type:Number,default:undefined},min:{type:Number,default:undefined},tooltip:{type:Boolean,default:true},tooltipRender:{type:Function},tooltipLegendRender:{type:Function},xTooltipRender:{type:Function},yTooltipRender:{type:Function},zTooltipRender:{type:Function},legend:{type:[Boolean,Array]},legendPosition:{type:String,default:'bottom',validator:t=>['top','bottom','left','right'].includes(t)},legendRender:{type:Function},distributed:{type:Boolean,default:false},currency:{type:Boolean,default:false},xDate:{type:[Boolean,String],default:false},nodata:{type:String,default:bbn._('No data')},odd:{type:Boolean,default:false},even:{type:Boolean,default:false},onlyInteger:{type:Boolean,default:false},ticksNumber:{type:[String,Number]},toolbar:{type:Boolean,default:true},toolbarDownload:{type:[Boolean,String],default:false},toolbarSelection:{type:[Boolean,String],default:true},toolbarZoom:{type:[Boolean,String],default:true},toolbarZoomin:{type:[Boolean,String],default:true},toolbarZoomout:{type:[Boolean,String],default:true},toolbarPan:{type:[Boolean,String],default:true},toolbarReset:{type:[Boolean,String],default:true},toolbarCustom:{type:Array,default(){return[];}},cfg:{type:Object,default(){return{};}}},data(){return{container:false,containerHeight:0,containerWidth:0,ready:false,isInit:false,widget:false,id:bbn.fn.randomString()}},computed:{data(){let series=this.source.series,data=[]
if(this.isLine||this.isBar||this.isArea){if(bbn.fn.isArray(series)&&series.length){if(!bbn.fn.isArray(series[0])){data.push({data:this.even||this.odd?bbn.fn.filter(series,(v,k)=>{k++;return(this.even&&(k%2===0))||(this.odd&&(k%2>0));}):series})}
else{bbn.fn.each(series,(s,i)=>{if(bbn.fn.isObject(s)){}
else{data.push({data:this.even||this.odd?bbn.fn.filter(s,(v,k)=>{k++;return(this.even&&(k%2===0))||(this.odd&&(k%2>0));}):s,name:this.legend&&this.legend.length?this.legend[i]:false})}})}}}
else if(this.isPie||this.isDonut||this.isRadial){data=this.even||this.odd?bbn.fn.filter(this.source.series,(v,k)=>{k++;return(this.even&&(k%2===0))||(this.odd&&(k%2>0));}):this.source.series}
return data;},isLine(){return this.type==='line';},isBar(){return this.type==='bar';},isPie(){return(this.type==='pie')&&!this.donut;},isDonut(){return(this.type==='donut')||((this.type==='pie')&&!!this.donut);},isArea(){return this.type==='area';},isRadial(){return this.type==='radial';},colors(){let colors=[];if(typeof this.color==='string'){colors=[this.color];}
if(Array.isArray(this.color)){colors=this.color;}
return bbn.fn.map(colors,c=>{if((c.indexOf('#')!==0)||(c.toLowerCase().indexOf('rgb')!==0)){return bbn.fn.colorToHex(c);}
return c;});},lineCfg(){let cfg={};return this.isLine?bbn.fn.extend(true,cfg,this.lineBarAreaCommon,this.lineAreaCommon):{}},barCfg(){let cfg={chart:{stacked:!!this.stacked},plotOptions:{bar:{horizontal:!!this.horizontal,distributed:this.distributed}}};if(this.barsDistance){cfg.stroke={show:true,width:this.barsDistance,colors:['transparent']};}
return this.isBar?bbn.fn.extend(true,cfg,this.lineBarAreaCommon):{};},areaCfg(){let cfg={}
return this.isArea?bbn.fn.extend(true,cfg,this.lineAreaCommon):{}},lineAreaCommon(){let cfg={markers:{size:this.points||0},stroke:{curve:!!this.smooth?'smooth':(!!this.step?'stepline':'straight')}};return this.isLine||this.isArea?bbn.fn.extend(true,cfg,this.lineBarAreaCommon):{}},lineBarAreaCommon(){if(this.isLine||this.isBar||this.isArea){let cfg={xaxis:{labels:{show:!!this.labels&&!!this.xLabels&&this.data.length,style:{colors:this.xLabelsColor||(this.labelsColor||[]),cssClass:'bbn-chart-xaxis-label'},offsetX:this.xLabelsOffsetX,offsetY:this.xLabelsOffsetY,showDuplicates:true},title:{text:this.xTitle,style:{cssClass:'bbn-chart-xaxis-title'}}},yaxis:{labels:{show:!!this.labels&&!!this.xLabels&&this.data.length,style:{colors:this.yLabelsColor||(this.labelsColor||[]),cssClass:'bbn-chart-yaxis-label'},offsetX:this.yLabelsOffsetX,offsetY:this.yLabelsOffsetY},title:{text:this.yTitle,style:{cssClass:'bbn-chart-yaxis-title'}},min:this.min,max:this.max},grid:{show:!!this.grid&&(!!this.xGrid||!!this.yGrid),xaxis:{lines:{show:!!this.xGrid}},yaxis:{lines:{show:!!this.yGrid}}}}
if(this.xDate){cfg.xaxis.type='datetime';if(bbn.fn.isString(this.xDate)){cfg.xaxis.labels.formatter=(value,timestamp,index)=>{return dayjs(timestamp).format(this.xDate);}}}
if(this.onlyInteger){cfg.yaxis.decimalsInFloat=3;}
if(this.ticksNumber){cfg.yaxis.tickAmount=parseInt(this.ticksNumber);}
if(this.gridColor){cfg.grid.borderColor=this.gridColor;}
if(this.gridBackground){cfg.grid.row={colors:[this.gridBackground]};}
if(this.currency){cfg.dataLabels={formatter:(val,opts)=>{return bbn.fn.money(val);}};if(this.tooltip){cfg.tooltip={y:{formatter:val=>{return bbn.fn.money(val);}}};}}
if(this.xLabelsRotate){cfg.xaxis.labels.rotate=this.xLabelsRotate;cfg.xaxis.labels.rotateAlways=true;}
if(this.yLabelsRotate){cfg.yaxis.labels.rotate=this.yLabelsRotate;}
if(this.labelsRender||this.xLabelsRender){cfg.xaxis.labels.formatter=this.xLabelsRender||this.labelsRender;}
if(this.labelsRender||this.yLabelsRender){cfg.yaxis.labels.formatter=this.yLabelsRender||this.labelsRender;}
if(Object.keys(this.xAxis).length){bbn.fn.extend(true,cfg.xaxis,this.xAxis);}
if(Object.keys(this.yAxis).length){bbn.fn.extend(true,cfg.yaxis,this.yAxis);}
return cfg;}
return{};},pieCfg(){let cfg={}
return this.isPie?bbn.fn.extend(true,cfg,this.pieDonutCommonCfg):{}},donutCfg(){let cfg={chart:{type:'donut'}}
if(bbn.fn.isNumber(this.donut)){cfg.plotOptions={pie:{donut:{size:this.donut+'%'}}}}
return this.isDonut?bbn.fn.extend(true,cfg,this.pieDonutCommonCfg):{}},pieDonutCommonCfg(){if(this.container&&(this.isPie||this.isDonut)){let cfg={legend:{show:!!this.legend},dataLabels:{enabled:!!this.labels&&this.data.length}};if(this.labelsColor){cfg.dataLabels.style={colors:[this.labelsColor]};}
if(this.currency){cfg.dataLabels.formatter=(val,opts)=>{return bbn.fn.money(opts.w.config.series[opts.seriesIndex]);};if(this.tooltip){cfg.tooltip={y:{formatter:val=>{return bbn.fn.money(val);}}};}}
if(this.labelsRender){cfg.dataLabels.formatter=this.labelsRender;}
if(this.labelsOffsetX){cfg.dataLabels.offsetX=this.labelsOffsetX;}
if(this.labelsOffsetY){cfg.dataLabels.offsetY=this.labelsOffsetY;}
if(this.containerHeight&&this.containerWidth&&(this.width==='100%')&&(this.height==='100%')){cfg.chart={};if(this.containerWidth<this.containerHeight){cfg.chart.width=this.containerWidth;cfg.chart.height=this.containerWidth;}
else{cfg.chart.width='100%';cfg.chart.height=this.containerHeight;}}
return cfg;}
return{};},radialCfg(){let cfg={chart:{type:'radialBar'},plotOptions:{radialBar:{dataLabels:{total:{show:true,label:bbn._('TOTAL')}}}}}
return this.isRadial?cfg:{}},widgetCfg(){let cfg={chart:{id:this.id,type:this.type,height:this.height,width:this.width,animations:{enabled:!!this.animation,speed:bbn.fn.isNumber?this.animation:800,easing:'easeinout',animateGradually:{enabled:true,delay:250},dynamicAnimation:{enabled:true,speed:350}},toolbar:{show:this.toolbar,tools:{download:this.toolbarDownload,selection:this.toolbarSelection,zoom:this.toolbarZoom,zoomin:this.toolbarZoomin,zoomout:this.toolbarZoomout,pan:this.toolbarPan,reset:this.toolbarReset,customIcons:this.toolbarCustom}},defaultLocale:'en',locales:[{name:'en',options:{months:[bbn._('January'),bbn._('February'),bbn._('March'),bbn._('April'),bbn._('May'),bbn._('June'),bbn._('July'),bbn._('August'),bbn._('September'),bbn._('October'),bbn._('November'),bbn._('December')],shortMonths:[bbn._('Jan'),bbn._('Feb'),bbn._('Mar'),bbn._('Apr'),bbn._('May'),bbn._('Jun'),bbn._('Jul'),bbn._('Aug'),bbn._('Sep'),bbn._('Oct'),bbn._('Nov'),bbn._('Dec')],days:[bbn._('Sunday'),bbn._('Monday'),bbn._('Tuesday'),bbn._('Wednesday'),bbn._('Thursday'),bbn._('Friday'),bbn._('Saturday')],shortDays:[bbn._('Sun'),bbn._('Mon'),bbn._('Tue'),bbn._('Wed'),bbn._('Thu'),bbn._('Fri'),bbn._('Sat')],toolbar:{download:bbn._('Download SVG'),selection:bbn._('Selection'),selectionZoom:bbn._('Selection Zoom'),zoomIn:bbn._('Zoom In'),zoomOut:bbn._('Zoom Out'),pan:bbn._('Panning'),reset:bbn._('Reset Zoom')}}}],events:{click:(event,chartContext,config)=>{this.$emit('click',event,chartContext,config);}}},series:this.data,labels:this.getLabels(),legend:{show:this.legend&&this.legend.length,position:this.legendPosition,itemMargin:{horizontal:5,vertical:5},formatter:this.legendRender||undefined},dataLabels:{enabled:!!this.pointsLabels},tooltip:{enabled:!!this.tooltip,x:{formatter:this.xTooltipRender||undefined},y:{formatter:this.yTooltipRender||this.tooltipRender||undefined,title:{formatter:this.tooltipLegendRender||undefined}},z:{formatter:this.zTooltipRender||undefined}},colors:this.colors.length?this.colors:undefined,fill:{type:this.fill,opacity:this.opacity},theme:{mode:this.theme},noData:{text:this.nodata}}
if(this.background){cfg.chart.background=this.background;}
if(this.opacity&&(this.fill==='gradient')){cfg.fill.gradient={shadeIntensity:1,opacityFrom:this.opacity,opacityTo:1};}
if(this.legendPosition==='bottom'){cfg.legend.offsetY=-5;}
if(this.isLine){bbn.fn.extend(true,cfg,this.lineCfg,this.cfg)}
else if(this.isBar){bbn.fn.extend(true,cfg,this.barCfg,this.cfg)}
else if(this.isPie){bbn.fn.extend(true,cfg,this.pieCfg,this.cfg)}
else if(this.isDonut){bbn.fn.extend(true,cfg,this.donutCfg,this.cfg)}
else if(this.isRadial){bbn.fn.extend(true,cfg,this.radialCfg,this.cfg)}
else if(this.isArea){bbn.fn.extend(true,cfg,this.areaCfg,this.cfg)}
return cfg}},methods:{init(emptyData){this.destroy();this.setSizes();this.$nextTick(()=>{if(!this.widget){let cfg=bbn.fn.extend(true,{},this.widgetCfg);if(emptyData){cfg.series=[];cfg.labels=[];}
this.widget=new ApexCharts(this.getRef('chart'),cfg)
this.widget.render();this.isInit=true;}})},destroy(){if(this.widget&&this.ready){this.widget.destroy();this.widget=false;}},setSizes(){this.containerHeight=this.container.offsetHeight;this.containerWidth=this.container.offsetWidth;},onResize(){if(this.ready){this.$nextTick(()=>{this.setSizes();if(this.widget){}})}},updateWidget(cfg){if(this.widget&&this.ready){this.widget.updateOptions(bbn.fn.extend(true,{},cfg||this.widgetCfg),!!this.isBar,!!this.animation);}},getLabels(){return this.data&&this.data.length?(this.source.labels?(this.even||this.odd?bbn.fn.filter(this.source.labels,(v,k)=>{k++;return(this.even&&(k%2===0))||(this.odd&&(k%2>0));}):this.source.labels):[]):[]}},watch:{ready(newVal){this.$nextTick(()=>{if(newVal){this.init();}});},widgetCfg:{deep:true,handler(newVal,oldVal){if(this.ready&&this.isInit){if(newVal.chart.type!==oldVal.chart.type){this.isInit=false;this.init(true);}
else{this.updateWidget();}}}}},mounted(){this.container=this.getRef('container');this.$nextTick(()=>{this.ready=true;})}});})(bbn);if(bbn_resolve){bbn_resolve("ok");}};document.head.insertAdjacentElement("beforeend",script_dep);})(bbn);}
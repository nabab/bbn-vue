(bbn_resolve)=>{((bbn)=>{let script=document.createElement('script');script.innerHTML=`<div :class="[componentClass, 'bbn-overlay', 'bbn-flex-height']">
   <div class="bbn-w-100 bbn-c bbn-lg bbn-vlpadded">
      <bbn-input :placeholder="placeholder"
                 :style="{width: '75%'}"
                 :focused="true"
                 type="search"
                 ref="input"
                 @keydown="keydown"
                 :nullable="isNullable"
                 autocomplete="off"
                 v-model="filterString"
                 :loading="isAjax && isLoading"
                 button-right="nf nf-fa-search"/>
   </div>
   <div class="bbn-flex-fill">
      <bbn-scroll>
         <bbn-list v-if="filteredData.length && !disabled && !readonly"
                  :element="$el"
                  ref="list"
                  :auto-hide="false"
                  :suggest="suggest"
                  :component="searchComponent"
                  :children="null"
                  @select="select"
                  :source-url="sourceUrl"
                  :source-action="sourceAction"
                  :source-text="sourceText"
                  :source-value="sourceValue"
                  :pageable="filteredData.length > limit"
                  :pager-element="_self"
                  :source="filteredData"/>
      </bbn-scroll>
   </div>
  <input type="hidden"
         v-model="value"
         ref="element"
         :name="name">
</div>
`;script.setAttribute('id','bbn-tpl-component-search');script.setAttribute('type','text/x-template');document.body.insertAdjacentElement('beforeend',script);let css=document.createElement('link');css.setAttribute('rel','stylesheet');css.setAttribute('href',bbn.vue.libURL+'dist/js/components/search/search.css');document.head.insertAdjacentElement('beforeend',css);((bbn,Vue)=>{"use strict";Vue.component('bbn-search',{mixins:[bbn.vue.basicComponent,bbn.vue.eventsComponent,bbn.vue.inputComponent,bbn.vue.resizerComponent,bbn.vue.listComponent,bbn.vue.keynavComponent,bbn.vue.urlComponent,bbn.vue.dropdownComponent],props:{filterselection:{default:false},filterable:{type:Boolean,default:true},autobind:{default:false},nullable:{default:false},minLength:{type:Number,default:1},leftIcon:{default:false},rightIcon:{default:'nf nf-fa-search'},minWidth:{default:'4.2em'},maxWidth:{default:'100%'},delay:{type:Number,default:500},shortPlaceholder:{type:String,default:'?'},autohide:{type:[Boolean,Number],default:1500},sourceAction:{type:[String,Function],default:'action'},sourceUrl:{type:[String,Function],default:'url'},},data(){return{specialWidth:this.minWidth,currentPlaceholder:this.shortPlaceholder,timeout:null,mouseTimeout:null};},computed:{isNullable(){return this.nullable&&this.isActive;},searchComponent(){let cp=bbn.fn.isString(this.component)||(bbn.fn.isObject(this.component)&&Object.keys(this.component).length)?this.component:null;if(!cp){cp={props:['source'],data(){return this.source;},template:`<component :is="myCp" :source="source"></component>`,computed:{myCp(){return this.source.component||'div';}}};}
bbn.fn.log(cp,this.source);return cp;},},methods:{select(item,idx,dataIndex){if(!this.disabled){let ev=new Event('select',{cancelable:true});this.$emit('select',ev,item,idx,dataIndex);bbn.fn.log("EMITTING SELECT");if(!ev.defaultPrevented){bbn.fn.log("NO RPEVENT",item);if(this.sourceAction&&item[this.sourceAction]){if(typeof(item[this.sourceAction])==='string'){if(bbn.fn.isFunction(this[item[this.sourceAction]])){this[item[this.sourceAction]]();}}
else if(bbn.fn.isFunction(item[this.sourceAction])){if(this.actionArguments){item[this.sourceAction](...this.actionArguments);}
else{item[this.sourceAction](idx,item.data);}}}
else if(this.sourceUrl&&item[this.sourceUrl]){bbn.fn.log("SOURCE URL OK");let url=bbn.fn.isFunction(this.sourceUrl)?this.sourceUrl(item,idx,dataIndex):item[this.sourceUrl];if(url){bbn.fn.link(url);}}}}},keydown(e){if((e.key===' ')||this.commonKeydown(e)){return;}
if(e.key==='Escape'){this.resetDropdown();}
else if(bbn.var.keys.upDown.includes(e.keyCode)){this.keynav(e);}},},watch:{filterString(v){if(!this.ready){this.ready=true;}
clearTimeout(this.filterTimeout);if(v!==this.currentText){this.emitInput(v);this.$emit('change',v);if(this.currentData.length){this.currentData.splice(0);}
this.$nextTick(()=>{this.filterTimeout=setTimeout(()=>{this.filterTimeout=false;if(v&&(v.length>=this.minLength)){this.$once('dataloaded',()=>{this.$nextTick(()=>{let list=this.find('bbn-scroll');if(list){list.onResize();}});});this.currentFilters.conditions.splice(0,this.currentFilters.conditions.length?1:0,{field:this.sourceText,operator:'startswith',value:v});}
else{this.unfilter();}},this.delay);})}}}});})(bbn,Vue);if(bbn_resolve){bbn_resolve("ok");}})(bbn);}
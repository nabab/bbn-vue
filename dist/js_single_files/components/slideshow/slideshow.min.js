((bbn)=>{let script=document.createElement('script');script.innerHTML=`<div :class="[componentClass, 'bbn-overlay']">
  <div v-if="ready"
       :class="['bbn-100', {'bbn-padded' : !fullSlide}]"
  >
    <!-- position aboslute -->
    <div class="bbn-l bbn-slideshow-count bbn-abs"
         v-if="showCount"
    >
      <span class="bbn-xl" v-text="(currentIndex+1) + '/' + items.length"></span>
    </div>

    <div class="bbn-100 bbn-flex-width">

      <div v-if="summary && items.length"
           class="first bbn-flex-fill bbn-slide"
           :style="{display: currentIndex === 0 ? 'block' : 'none'}">
        <h2 v-text="_('Summary')"></h2>
        <ol class="bbn-l bbn-lg">
          <li v-for="(it, i) in items">
            <a href="javascript:;"
               @click="currentIndex = i+1"
               v-text="it.title ? it.title : _('Untitled')"></a>
          </li>
        </ol>
      </div>

      <div class="bbn-flex-fill bbn-flex-height">
        <div class="bbn-flex-fill">
          <div class="bbn-overlay bbn-flex-width">
            <!--Left arrow-->
            <div  v-if="arrows"
                  class="bbn-middle bbn-padded bbn-slideshow-arrow-left"
                  @mouseover="arrowsPreview('prev', true)"
                  @mouseleave="arrowsPreview('prev', false)"
            >
              <i  v-show="showArrowLeft"
                  :class="[arrowClass.left, 'bbn-p', 'bbn-xxxl']"
                  @click="prev"
                  :style="{visibility: (currentIndex === 0 && !loop)? 'hidden' : 'visible'}"
              ></i>
            </div>
            <div class="bbn-flex-fill">
              <div class="bbn-overlay" ref="slideContainer">
                <!-- Items-->
                <div v-for="(it, i) in items"
                    :class="['bbn-overlay', 'bbn-slideshow-slide', 'sliden' + (summary ? i + 1 : i).toString(), !summary && (i === 0) ? 'first' : '', items[i].class ? items[i].class : '']"
                    :id="name + (summary ? i : i + 1).toString()"
                    :style="{display: currentIndex === (summary ? i + 1 : i) ? 'block' : 'none'}"
                >
                  <div v-if="it.type === 'text'"
                       :ref="'slide' + i.toString()"
                       :class="['bbn-slideshow-content', (it.animation ? 'bbn-slideshow-effect-' + it.animation : ''), it.cls || '', 'bbn-middle', 'bbn-m']"
                  >
                    <component v-if="it.component"
                               :is="it.component"
                               :data="it.data || {}"
                               v-bind="it.attributes"
                               :key="i"
                    ></component>
                    <component v-else-if="component"
                               :is="component"
                               :content="it.content || ''"
                               :data="it.data || {}"
                    ></component>
                    <div v-else-if="it.content"
                         :ref="'slide' + i.toString()"
                         :class="[(it.animation ? 'bbn-slideshow-effect-' + it.animation : ''), 'bbn-overlay']"
                    >
                      <bbn-scroll v-if="scroll">
                        <div v-html="it.content"></div>
                      </bbn-scroll>
                      <div v-else v-html="it.content"></div>
                    </div>
                  </div>
                  <!--only image-->
                  <div v-else-if="it.type === 'img'"
                       :ref="'slide' + i.toString()"
                       :class="[(it.animation ? 'bbn-slideshow-effect-' + it.animation : ''), 'bbn-overlay', 'bbn-middle']"
                  >
                    <div class="bbn-overlay bbn-middle">
                      <img :src="it.content"
                          :ref="'slide-img'+ i.toString()"
                          @load="afterLoad(i)"
                          :class="['img' + i.toString()]"
                          :width="it.imageWidth || 'auto'"
                          :height="it.imageHeight || 'auto'"
                          :style="{
                            marginLeft: it.imageLeftMargin || 0,
                            marginTop: it.imageTopMargin || 0,
                            visibility: it.showImg ? 'visible' : 'hidden',
                            maxWidth: it.imageMaxWidth || '',
                            maxHeight: it.imageMaxHeight || ''
                          }"
                      >
                    </div>
                  </div>
                  <bbn-checkbox v-if="checkbox && it.checkable"
                                v-model="valuesCB[i]"
                                :value="true"
                                :novalue="false"
                                :strict="true"
                                :label="(typeof checkbox === 'string') ? checkbox : defaultTextCB"
                                class="bbn-slideshow-showagain"
                  ></bbn-checkbox>
                </div>
              </div>
              <div v-if="ctrl"
                   class="bbn-overlay bbn-middle">
                <!-- Commands-->
                <div class="bbn-primary-text-alt bbn-slideshow-commands bbn-middle"
                    @mouseover="ctrlPreview(true)"
                    @mouseleave="ctrlPreview(false)"
                >
                  <i v-show="showCtrl"
                      :class="[{
                        'nf nf-fa-pause': !!scrollInterval,
                        'nf nf-fa-play': !scrollInterval,
                      }, 'bbn-p', 'bbn-xxxl']"
                      @click="scrollInterval ? stopAutoPlay() : startAutoPlay()"
                  ></i>
                </div>
              </div>
            </div>
            <!-- Right arrow-->
            <div v-if="arrows"
                  class="bbn-middle bbn-padded bbn-slideshow-arrow-right"
                  @mouseover="arrowsPreview('next', true)"
                  @mouseleave="arrowsPreview('next', false)"
            >
              <i v-show="showArrowRight"
                  :class="[arrowClass.right, 'bbn-p', 'bbn-xxxl']"
                  @click="next"
                  :style="{visibility: (currentIndex >= items.length - 1) && !loop ? 'hidden' : 'visible'}"
              ></i>
            </div>
          </div>
        </div>
        <div v-if="showInfo && items[currentIndex].info && items[currentIndex].info.length"
             class="bbn-middle bbn-padded bbn-slideshow-info"
             v-html="items[currentIndex].info"
        ></div>
        <!-- Miniatures -->
        <div v-if=" preview === true || preview === 'image' || preview === 'circle'"
             :class="['bbn-block', 'bbn-middle', 'bbns-gallery-miniature', 'bbn-hsmargin', {
               'bbn-top-sspace': !showInfo || !items[currentIndex].info || !items[currentIndex].info.length
             }]"
             :style="{'min-height': dimensionPreview + 'px'}"
             @mouseover="miniaturePreview(true)"
             @mouseleave="miniaturePreview(false)"
        >
          <component :is="$options.components.miniature"
                      v-show="showMiniature"
                      :items="items"
                      :type="preview"
                      :dimension="dimensionPreview"
                      ref="miniatures"
          ></component>
        </div>
      </div>

    </div>

    <!--old arrows-->
    <div v-if="items.length && !arrows && (preview === false) && navigation"
         class="bbn-slideshow-navigation"
    >
      <div class="bbn-100">
        <a href="javascript:;"
           v-if="summary"
           :title="_('Summary')"
           @click="currentIndex = 0"
           :style="{visibility: currentIndex === 0 ? 'hidden' : 'visible'}"
           class="bbn-slideshow-summary"
        >
          <i class="nf nf-fa-align_justify"></i>
        </a>
        <a href="javascript:;"
           @click="prev"
           :title="_('Previous')"
           :style="{visibility: currentIndex === 0 ? 'hidden' : 'visible'}"
           class="bbn-slideshow-prev"
        >
          <i class="nf nf-fa-arrow_circle_left"></i>
        </a>
        <a href="javascript:;"
            @click="next"
            :title="_('Next')"
            :style="{visibility: currentIndex >= (summary ? items.length : items.length - 1) ? 'hidden' : 'visible'}"
            class="bbn-slideshow-next"
        >
          <i class="nf nf-fa-arrow_circle_right"></i>
        </a>
      </div>
    </div>
  </div>
  <div class="bbn-hidden" ref="slot">
    <slot></slot>
  </div>
</div>
`;script.setAttribute('id','bbn-tpl-component-slideshow');script.setAttribute('type','text/x-template');document.body.insertAdjacentElement('beforeend',script);(()=>{"use strict";Vue.component('bbn-slideshow',{mixins:[bbn.vue.basicComponent,bbn.vue.resizerComponent],props:{source:{type:[Array,Function,String]},separator:{type:String},component:{type:[String,Object,Vue]},checkbox:{type:[String,Boolean],default:false},summary:{type:Boolean,default:false},gallery:{type:Boolean,default:false},preview:{type:[Boolean,String],default:false},dimensionPreview:{type:Number,default:45},autoPlay:{type:[Boolean,Number],default:false},ctrl:{type:[Boolean,String],default:false},arrows:{type:[Boolean,Object],default:false},navigation:{type:Boolean,default:false},autoHidePreview:{type:Boolean,default:false},autoHideArrows:{type:Boolean,default:false},autoHideCtrl:{type:Boolean,default:true},loop:{type:Boolean,default:false},fullSlide:{type:Boolean,default:false},initialSlide:{type:Number,default:0},showCount:{type:Boolean,default:false},showInfo:{type:Boolean,default:false},scroll:{type:Boolean,default:false}},data(){let src=[],valuesCB={},isAjax=false;if(bbn.fn.isString(this.source)){if(this.separator){src=this.source.split(this.separator).map(a=>{return{content:a,type:'text'};});}
else{isAjax=true;}}
else if(bbn.fn.isFunction(this.source)){src=this.source();}
else if(bbn.fn.isArray(this.source)){if(this.checkbox){if(this.separator){this.source.forEach((v,i)=>{v.content.split(this.separator).forEach((a,k)=>{let o={type:'text',content:a,id:v.id};if(k===0){o.checkable=true;}
src.push(o);});valuesCB[i]=false;});}}
else{src=bbn.fn.extend(true,[],this.source).map(val=>{if(bbn.fn.isString(val)){val={type:this.gallery?'img':'text',content:val};if(val.type==='img'){bbn.fn.extend(val,{imageWidth:0,imageHeight:0,imageLeftMargin:0,imageTopMargin:0,showImg:false});}}
if(bbn.fn.isObject(val)&&(!val.type||((val.type!=='img')&&(val.type!=='text')))){val.type='text';}
return bbn.fn.isObject(val)?val:{};});}}
return{name:bbn.fn.randomString().toLowerCase(),currentIndex:this.initialSlide>src.length?0:this.initialSlide,items:src,isAjax:isAjax,defaultTextCB:bbn._("Don't show it again"),valuesCB:valuesCB,activeMiniature:0,defaultAutoPlay:5000,scrollInterval:false,showMiniature:this.autoHidePreview?false:true,showArrowLeft:this.autoHideArrows?false:true,showArrowRight:this.autoHideArrows?false:true,showCtrl:this.autoHideCtrl?false:true,arrowClass:{left:'nf nf-fa-arrow_circle_left',right:'nf nf-fa-arrow_circle_right',},imageWidth:0,imageHeight:0,imageLeftMargin:0,imageTopMargin:0}},methods:{onResize(){this.setContainerMeasures();this.setResizeMeasures();if(bbn.fn.isArray(this.source)&&this.source.length){this.source.forEach((v,i)=>{if(v.loaded){this.aspectRatio(i);}});}},afterLoad(idx){this.$set(this.items[idx],'loaded',true);this.aspectRatio(idx);},aspectRatio(idx){this.$nextTick(()=>{let cont=this.getRef('slideContainer'),ctnRatio=cont.offsetWidth/cont.offsetHeight,img=this.getRef('slide-img'+idx.toString()),imgW=img.naturalWidth,imgH=img.naturalHeight,imgRatio=imgW/imgH,diff=Math.abs(ctnRatio-imgRatio),mode=this.items[idx].mode?this.items[idx].mode:'original';if(imgRatio>ctnRatio){if(mode==='zoom'){this.$set(this.items[idx],'imageWidth','auto');this.$set(this.items[idx],'imageHeight','100%');this.$set(this.items[idx],'showImg',true);}
if(mode==='full'){this.$set(this.items[idx],'imageWidth','100%');this.$set(this.items[idx],'imageHeight','auto');this.$set(this.items[idx],'showImg',true);}}
if(imgRatio<ctnRatio){if(mode==='zoom'){this.$set(this.items[idx],'imageWidth','100%');this.$set(this.items[idx],'imageHeight','auto');this.$set(this.items[idx],'showImg',true);}
if(mode==='full'){this.$set(this.items[idx],'imageWidth','auto');this.$set(this.items[idx],'imageHeight','100%');this.$set(this.items[idx],'showImg',true);}}
if(mode==='stretch'){this.$set(this.items[idx],'imageWidth',cont.offsetWidth+'px');this.$set(this.items[idx],'imageHeight',cont.offsetHeight+'px');this.$set(this.items[idx],'showImg',true);}
if(mode==="original"){this.$set(this.items[idx],'showImg',true);}
if(cont.offsetWidth){this.$set(this.items[idx],'imageMaxWidth',cont.offsetWidth+'px');}
if(cont.offsetHeight){this.$set(this.items[idx],'imageMaxHeight',cont.offsetHeight+'px');}});},createStyle(){let st='',rules=[];this.items.forEach((it,i)=>{st+='.bbn-slideshow .slideswitch:target ~ .bbn-slideshow-slide#'+(this.name+i.toString())+' .bbn-slideshow-content{opacity: 0}';st+='.bbn-slideshow .slideswitch[id="'+this.name+i.toString()+'"]:target ~ .bbn-slideshow-slide#'+this.name+i.toString()+' .bbn-slideshow-navigation {display: block !important;}';st+='.bbn-slideshow .slideswitch[id="'+this.name+i.toString()+'"]:target ~ .bbn-slideshow-slide#'+this.name+i.toString()+' .bbn-slideshow-content {animation-name: bbn-slideshow-effect-fade_in; animation-duration: 0.5s;}';if(it.animation){st+='.bbn-slideshow .slideswitch[id="'+this.name+i.toString()+'"]:target ~ #'+this.name+i.toString()+' .bbn-slideshow-effect-'+it.animation+' {animation-name: bbn-slideshow-effect-'+it.animation+' !important;animation-duration: '+(it.duration||this.duration||'0.5')+'s;'+(it.animation==='flip'?'backface-visibility: hidden;':'')+'}';}});return st;},prev(){let idx=this.currentIndex;if((idx>0)&&this.items[idx-1]){if(!this.items[idx-1].animation){let slide=this.getRef('slide'+(idx-1).toString());if(slide){slide.style.animationName='bbn-slideshow-effect-slide_from_right';}}
this.currentIndex--;}
if(this.loop&&idx===0){this.currentIndex=this.items.length-1;}
if(this.autoPlay){this.stopAutoPlay();this.$nextTick(()=>{this.startAutoPlay();});}},next(){let idx=this.currentIndex;if(this.summary){idx--;}
if(idx<(this.items.length-1)&&this.items[idx+1]){if(!this.items[idx+1].animation){let slide=this.getRef('slide'+(idx-1).toString());if(slide){slide.style.animationName='bbn-slideshow-effect-slide_from_left';}}
this.currentIndex++;}
if(this.loop&&(idx===(this.items.length-1))){this.currentIndex=0;}
if(this.autoPlay){this.stopAutoPlay();this.$nextTick(()=>{this.startAutoPlay();});}},startAutoPlay(){this.scrollInterval=setInterval(()=>{if(this.currentIndex<(this.items.length-1)){this.next();}
else if(this.currentIndex===(this.items.length-1)){this.currentIndex=0;}
if(this.preview){this.activeMiniature=this.currentIndex;}},typeof(this.autoPlay)==='number'?this.autoPlay*1000:this.defaultAutoPlay);},stopAutoPlay(){if(this.scrollInterval){clearInterval(this.scrollInterval);this.scrollInterval=false;}},miniaturePreview(val){if(this.autoHidePreview){this.showMiniature=val;}},arrowsPreview(direction,val){if(this.autoHideArrows){if(direction==='next'){this.showArrowRight=val;}
if(direction==='prev'){this.showArrowLeft=val;}}},ctrlPreview(val){if(this.autoHideCtrl){this.showCtrl=val;}}},mounted(){if(!this.isAjax&&!this.items.length&&this.getRef('slot').innerHTML.trim()){if(this.separator){this.items=this.getRef('slot').innerHTML.split(this.separator).map((txt,i)=>{let el=document.createElement('div'),title='';el.innerHTML=txt;if(el){let titles=el.querySelectorAll('h1,h2,h3,h4,h5');if(titles.length){bbn.fn.each(titles,(v,i)=>{let title=v.innerText.trim();})}}
return{content:txt,type:'text',title:title};});}
else{this.items=[{content:this.getRef('slot').innerHTML,type:'text'}]}}
this.$nextTick(()=>{this.createStyle();if(this.autoPlay){this.startAutoPlay();}
if(bbn.fn.isObject(this.arrows)){if(this.arrows.left&&this.arrows.left.length){this.arrowClass.left=this.arrows.left}
if(this.arrows.right&&this.arrows.right.length){this.arrowClass.right=this.arrows.right}}
this.ready=true;})},watch:{show(newVal,oldVal){if(newVal!=oldVal){this.$emit(newVal?"show":"hide");}},valuesCB:{deep:true,handler(newVal){this.$emit(newVal[this.currentIndex]?'check':'uncheck',this.items[this.currentIndex]);}},currentIndex(val){let miniatures=this.getRef('miniatures');if(miniatures){let scroll=miniatures.getRef('scroll');if(scroll){let xScroller=scroll.getRef('xScroller');if(xScroller){xScroller.scrollTo(miniatures.$refs.items[val]);}}}
this.$emit('changeSlide',val);}},components:{miniature:{template:`
          <bbn-scroll axis="x" ref="scroll">
            <div class="bbn-w-100 bbn-middle">
              <template  v-for="(it, i) in items">
                <i v-if="type === 'circle'"
                    @click= "clickMiniature(it , i)"
                    :class="[
                      (mainComponent.currentIndex === i ? 'nf nf-fa-dot_circle_o' : 'nf nf-fa-circle'),
                      'bbn-padded',
                      'bbn-slideshow-circleMiniature',
                      'bbn-p',
                      {'bbn-primary-text-alt': mainComponent.currentIndex === i}
                    ]"
                    ref="items"
                ></i>
                <div v-else
                     @click= "clickMiniature(it , i)"
                     :class="['bbn-slideshow-zoom', 'bbn-bordered-internal', {
                       'bbn-primary-border': mainComponent.currentIndex === i,
                       'bbn-right-xsspace': !!items[i+1]
                     }]"
                     :style="{
                       'border-width': (mainComponent.currentIndex === i) ? 'medium' : '',
                       width: dimension +'px',
                       height: dimension + 'px'
                     }"
                     ref="items"
                >
                  <div v-if="it.type === 'text'"
                      v-html="it.content"
                      class="bbn-slideshow-content"
                  ></div>
                  <img v-else-if="it.type === 'img'"
                      :src="getImgSrc(it.content)"
                      width="100%"
                      height="100%"
                  >
                </div>
              </template>
            </div>
          </bbn-scroll>`,props:{items:{type:Array,default(){return[]}},compare:{type:Boolean,default:true},type:{type:[Boolean,String],default:'image'},dimension:{type:Number,default:45}},data(){return{mainComponent:this.closest('bbn-slideshow')}},methods:{clickMiniature(miniature,idx){this.mainComponent.activeMiniature=idx;this.mainComponent.currentIndex=idx;if(this.mainComponent.autoPlay){this.mainComponent.stopAutoPlay();this.$nextTick(()=>{this.mainComponent.startAutoPlay();});}},getImgSrc(content){return content.match(/data\:image\/[a-zA-Z]*\;base64/)?content:`${content}${content.indexOf('?') > -1 ? '&' : '?'}w=${this.dimension}&thumb=1`;}},mounted(){const elem=this.$el.querySelector('div.bbn-slideshow-zoom div.bbn-slideshow-content');if(elem){elem.style.transform='scale(0.2)';if(elem.querySelector('img')){elem.querySelector('img').style.transform='scale(0.1)';}}}}}});})();})(bbn);
((bbn)=>{let script=document.createElement('script');script.innerHTML=`<div :class="[
       {
         'bbn-overlay': fullSize,
         'bbn-w-100': !fullSize && ((panes.lengh <= 1) || !isHorizontal),
         'bbn-h-100': !fullSize && (panes.lengh <= 1) && isHorizontal,
         'bbn-splitter-horizontal': isHorizontal,
         'bbn-splitter-vertical': !isHorizontal
       },
       componentClass
     ]"
     :style="{
       gridTemplateColumns: columnsCfg,
       gridTemplateRows: rowsCfg,
     }"
     @scroll.prevent.stop="preventScroll"
     v-show="panes.length"
>
  <slot></slot>
  <div v-for="(rs, i) in resizers"
       :class="[
         'bbn-unselectable',
         'bbn-middle',
         'bbn-splitter-bar',
         'bbn-light',
         'bbn-header',
         currentOrientation,
         {'bbn-splitter-resizer': !!rs.pane2},
         realResizerClass(rs)
       ]"
       ref="resizer"
       :style="{
          gridColumn: isHorizontal ? rs.position : 1,
          gridRow: !isHorizontal ? rs.position : 1,
          minWidth: resizerSize + 'px',
          minHeight: resizerSize + 'px',
          maxWidth: isHorizontal ? resizerSize + 'px' : null,
          maxHeight: isHorizontal ? null : resizerSize + 'px'
        }"
       @mousedown.prevent.stop="resizeStart($event, rs)"
       @touchstart.prevent.stop="resizeStart($event, rs)"
  >
    <div v-if="areCollapsible(rs.panec1, rs.panec2)"
         class="bbn-splitter-collapser"
         :style="{fontSize: (resizerSize * 1.2) + 'px'}">
      <div v-if="isCollapsiblePrev(rs.panec1, rs.panec2)"
           :class="{
             'bbn-w-100': isHorizontal,
             'bbn-h-100': !isHorizontal,
             'bbn-c': true
           }">
        <i :class="{
              'bbn-p': true,
              'nf nf-fa-angle_left': isHorizontal,
              'nf nf-fa-angle_up': !isHorizontal
            }"
            @click.stop="collapse(rs.panec1, rs.panec2)"
        ></i>
      </div>
      <div v-if="isCollapsibleNext(rs.panec1, rs.panec2)"
           :class="{
             'bbn-w-100': isHorizontal,
             'bbn-h-100': !isHorizontal,
             'bbn-c': true
           }">
        <i :class="{
             'bbn-p': true,
             'nf nf-fa-angle_right': isHorizontal,
             'nf nf-fa-angle_down': !isHorizontal
           }"
           @click.stop="collapse(rs.panec2, rs.panec1)"
        ></i>
      </div>
      <div v-if="isFullyCollapsiblePrev(rs.panec1, rs.panec2, i)"
           :class="{
             'bbn-w-100': isHorizontal,
             'bbn-h-100': !isHorizontal,
             'bbn-c': true
           }">
        <i :class="{
             'bbn-p': true,
             'nf nf-fa-angle_double_left': isHorizontal,
             'nf nf-fa-angle_double_up': !isHorizontal
           }"
           @click.stop="collapse(rs.panec1, rs.panec2, true)"
        ></i>
      </div>
      <div v-if="isFullyCollapsibleNext(rs.panec1, rs.panec2, i)"
           :class="{
             'bbn-w-100': isHorizontal,
             'bbn-h-100': !isHorizontal,
             'bbn-c': true
           }">
        <i :class="{
             'bbn-p': true,
             'nf nf-fa-angle_double_right': isHorizontal,
             'nf nf-fa-angle_double_down': !isHorizontal
           }"
           @click.stop="collapse(rs.panec2, rs.panec1, true)"
        ></i>
      </div>
    </div>
  </div>
</div>`;script.setAttribute('id','bbn-tpl-component-splitter');script.setAttribute('type','text/x-template');document.body.insertAdjacentElement('beforeend',script);(function(bbn){"use strict";Vue.component('bbn-splitter',{mixins:[bbn.vue.basicComponent,bbn.vue.resizerComponent],props:{orientation:{type:String,default:'auto'},resizable:{type:Boolean,default:false},collapsible:{type:Boolean,default:false},scrollable:{type:Boolean,default:false},resizerSize:{type:Number,default:15},resizerClass:{type:[String,Function]},minPaneSize:{type:Number,default:40},fullSize:{type:Boolean,default:true}},data(){return{initTimeout:0,isResized:false,isResizing:false,resizeCfg:null,resizers:[],currentOrientation:this.orientation,panes:[]};},computed:{isHorizontal(){return this.currentOrientation==='horizontal';},isResizable(){return(this.resizable||this.collapsible)&&(bbn.fn.count(this.panes,{resizable:true})>=2)},columnsCfg(){return this.panes.length&&this.isHorizontal?this.getFormatted():'auto';},rowsCfg(){return this.panes.length&&!this.isHorizontal?this.getFormatted():'auto';},currentAxis(){return this.isHorizontal?'x':'y'},currentSizeType(){return this.isHorizontal?'Width':'Height';},currentOffsetType(){return this.isHorizontal?'left':'top';},currentSize(){return this['lastKnown'+this.currentSizeType];},availableSize(){let availableSize=this.currentSize;bbn.fn.each(this.resizers,()=>{availableSize-=this.resizerSize;});return availableSize;},},methods:{getFormatted(){let pos=1,lastVisibleResizer=false,tmp=this.panes.map(a=>{let diff=a.currentDiff+a.savedDiff+a.tmpDiff,sz='';while(a.position>pos){sz+=lastVisibleResizer&&!a.title?'0 ':'max-content ';lastVisibleResizer=true;pos++;}
if(a.collapsed){sz+=a.title?'max-content ':'0 ';}
else{lastVisibleResizer=false;if(a.addedSize&&(a.addedSize==='auto')){sz+='auto';}
else if(a.size){if(a.addedSize||diff){sz+='calc( ';sz+=a.size+(a.isNumber?'px':'');if(diff){sz+=' + '+diff+'px';}
if(a.addedSize){sz+=' + '+(typeof a.addedSize==='number'?a.addedSize+'px':a.addedSize);}
sz+=')';}
else if(a.size){sz+=a.size+(a.isNumber?'px':'');}}
else{sz+='auto';}}
pos++;return sz;});return tmp.join(' ');},realResizerClass(resizer){if(bbn.fn.isFunction(this.resizerClass)){return this.resizerClass(resizer);}
return this.resizerClass||'';},getOrientation(){return this.lastKnownWidth>this.lastKnownHeight?'horizontal':'vertical';},onResize(){if(!this.isResizing){this.isResizing=true;this.setContainerMeasures();this.setResizeMeasures();if(this.orientation==='auto'){let o=this.getOrientation();if(o!==this.currentOrientation){this.currentOrientation=o;}}
let w=this.$el.style.width;let h=this.$el.style.height;this.$el.style.width='100%';this.$el.style.height='100%';setTimeout(()=>{this.$el.style.width=w;this.$el.style.height=h;this.isResizing=false;this.$emit('resize');},100)}},updatePositions(){},getNextResizable(idx,arr){for(let i=idx+1;i<arr.length;i++){if(arr[i].resizable){return i;}}
return false;},getPrevResizable(idx,arr){for(let i=idx-1;i>=0;i--){if(arr[i].resizable){return i;}}
return false;},getNextCollapsible(idx,arr){for(let i=idx+1;i<arr.length;i++){if(arr[i].collapsible){return i;}}
return false;},getPrevCollapsible(idx,arr){for(let i=idx-1;i>=0;i--){if(arr[i].collapsible){return i;}}
return false;},init(){clearTimeout(this.initTimeout);this.initTimeout=setTimeout(()=>{this.panes.splice(0,this.panes.length);let currentPosition=1,tmp=[],hasAuto=false,hasPercent=false,hasResizers=false;this.$children.forEach((pane,i)=>{if(pane.$vnode.componentOptions.tag==='bbn-pane'){let isPercent=false,isFixed=false,isNumber=false,props=JSON.parse(JSON.stringify(pane.$vnode.componentOptions.propsData)),resizable=(this.resizable||props.resizable)&&(props.resizable!==false),collapsible=(this.collapsible||props.collapsible)&&(props.collapsible!==false),value=parseInt(props.size)||0;if(props.size){isFixed=true;if(props.size==='auto'){props.size=false;hasAuto=true;}
else if((typeof props.size==='string')&&(bbn.fn.substr(props.size,-1)==='%')){isPercent=true;hasPercent=true;}
else if((typeof props.size==='string')&&(bbn.fn.substr(props.size,-2)==='px')){isNumber=true;props.size=parseInt(props.size);}
else if((typeof props.size==='number')){isNumber=true;}}
else{hasAuto=true;}
let obj=bbn.fn.extend({index:i,value:value,currentDiff:0,savedDiff:0,addedSize:'',tmpDiff:0,collapsed:false,isPercent:isPercent,isFixed:isFixed,isNumber:isNumber,resizable:resizable,collapsible:collapsible,isResizable:collapsible||resizable,pane:pane},props);tmp.push(obj);}});let isResizable=bbn.fn.count(tmp,{isResizable:true})>=2;let hasPanes=tmp.length>1;this.resizers.splice(0,this.resizers.length);tmp.forEach((pane,idx)=>{let prev,next,prevc,nextc;if(hasPanes&&isResizable&&pane.isResizable){prev=this.getPrevResizable(idx,tmp);next=this.getNextResizable(idx,tmp);prevc=this.getPrevCollapsible(idx,tmp);nextc=this.getNextCollapsible(idx,tmp);if((prev!==false)||(prevc!==false)){let o={position:currentPosition,panec1:false,panec2:false,pane1:false,pane2:false};if(pane.resizable&&(prev!==false)){o.pane1=prev;o.pane2=idx;}
if(pane.collapsible&&(prevc!==false)){o.panec1=prevc;o.panec2=idx;}
this.resizers.push(o);hasResizers=true;currentPosition++;}}
pane.position=currentPosition;this.panes.push(pane);currentPosition++;if(hasPanes&&isResizable&&pane.isResizable){let o={position:currentPosition,panec1:false,panec2:false,pane1:false,pane2:false};if(((prev===false)&&next&&!tmp[idx+1].resizable)||((prevc===false)&&nextc&&!tmp[idx+1].collapsible)){if(pane.resizable&&(prev===false)&&next&&!tmp[idx+1].resizable){o.pane1=idx;o.pane2=next;}
if(pane.collapsible&&(prevc===false)&&nextc&&!tmp[idx+1].collapsible){o.panec1=idx;o.panec2=nextc;}}
if(o.panec2||o.pane2){this.resizers.push(o);hasResizers=true;currentPosition++;}}});if(hasPercent&&hasResizers&&!hasAuto){throw bbn._('In a resizable splitter, if a pane has a percentage measure, at least one pane must be meausreless or set at "auto"');}
else{this.$forceUpdate();this.ready=true;this.selfEmit(true);}},200);},areCollapsible(idxPane1,idxPane2){return this.panes[idxPane1]&&this.panes[idxPane2]&&(this.panes[idxPane1].collapsible||this.panes[idxPane2].collapsible);},isCollapsiblePrev(idxPane1,idxPane2){return this.panes[idxPane2].collapsed||(!this.panes[idxPane1].collapsed&&((idxPane2===(this.panes.length-1))||!this.panes[idxPane2].collapsed))},isCollapsibleNext(idxPane1,idxPane2){return this.panes[idxPane1].collapsed||(!this.panes[idxPane2].collapsed&&((idxPane1===0)||!this.panes[idxPane2].collapsed))},isFullyCollapsiblePrev(idxPane1,idxPane2,idxResizer){return this.panes[idxPane2].collapsed&&(((idxPane2===(this.panes.length-1))&&(idxResizer===(this.resizers.length-1)))||(idxPane1===(idxPane2-1))||this.panes[idxPane1+1].collapsible)},isFullyCollapsibleNext(idxPane1,idxPane2,idxResizer){return this.panes[idxPane1].collapsed&&(((idxPane1===0)&&(idxResizer===0))||(idxPane1===(idxPane2-1))||(this.panes[idxPane2-1].collapsible))},resizeDrag(e){if(this.isResizing&&this.resizeCfg&&this.resizeCfg.panes){e.preventDefault();e.stopImmediatePropagation();let diff=(e['client'+this.currentAxis.toUpperCase()]||event.touches[0]['page'+this.currentAxis.toUpperCase()])-this.resizeCfg[this.currentOffsetType];if(diff>=this.resizeCfg.max){diff=this.resizeCfg.max;}
else if(diff<=this.resizeCfg.min){diff=this.resizeCfg.min;}
this.panes[this.resizeCfg.resizer.pane1].currentDiff=diff;this.panes[this.resizeCfg.resizer.pane2].currentDiff=-diff;}},resizeEnd(e){if(this.isResizing&&this.resizeCfg&&this.resizeCfg.panes){let diff=(e['client'+this.currentAxis.toUpperCase()]||event.touches[0]['page'+this.currentAxis.toUpperCase()])-this.resizeCfg[this.currentOffsetType];if(diff>=this.resizeCfg.max){diff=this.resizeCfg.max;}
else if(diff<=this.resizeCfg.min){diff=this.resizeCfg.min;}
this.panes[this.resizeCfg.resizer.pane1].currentDiff=0;this.panes[this.resizeCfg.resizer.pane2].currentDiff=0;this.panes[this.resizeCfg.resizer.pane1].savedDiff=this.panes[this.resizeCfg.resizer.pane1].savedDiff+diff;this.panes[this.resizeCfg.resizer.pane2].savedDiff=this.panes[this.resizeCfg.resizer.pane2].savedDiff-diff;this.isResizing=false;document.body.removeEventListener("touchmove",this.resizeDrag);document.body.removeEventListener("mousemove",this.resizeDrag);document.body.removeEventListener("touchend",this.resizeEnd);document.body.removeEventListener("touchcancel",this.resizeEnd);document.body.removeEventListener("mouseup",this.resizeEnd);document.body.removeEventListener("mouseleave",this.resizeEnd);this.panes[this.resizeCfg.resizer.pane1].pane.selfEmit(true);this.panes[this.resizeCfg.resizer.pane2].pane.selfEmit(true);this.resizeCfg=null;}},preventScroll(){this.$el.scrollLeft=0;this.$el.scrollTop=0;},resizeStart(e,rs){if(e.target.tagName.toLowerCase()==='i'){e.target.click();return}
if(this.isResizable&&!this.isResizing&&this.panes[rs.pane1]&&!this.panes[rs.pane1].collapsed&&this.panes[rs.pane2]&&!this.panes[rs.pane2].collapsed){this.isResizing=true;document.body.addEventListener("touchmove",this.resizeDrag);document.body.addEventListener("mousemove",this.resizeDrag);document.body.addEventListener("touchend",this.resizeEnd);document.body.addEventListener("touchcancel",this.resizeEnd);document.body.addEventListener("mouseup",this.resizeEnd);document.body.addEventListener("mouseleave",this.resizeEnd);let vue1=bbn.vue.find(this,'bbn-pane',rs.pane1),vue2=bbn.vue.find(this,'bbn-pane',rs.pane2),pos=e.target.getBoundingClientRect(),pos1=vue1.$el.getBoundingClientRect(),pos2=vue2.$el.getBoundingClientRect();if(!this.panes[rs.pane1].size&&!this.panes[rs.pane2].size){this.$set(this.panes[rs.pane1],"size",this.currentOrientation==='horizontal'?pos1.width:pos1.height);this.$set(this.panes[rs.pane2],"size",this.currentOrientation==='horizontal'?pos2.width:pos2.height);this.$forceUpdate();}
this.resizeCfg={resizer:rs,panes:[vue1,vue2],min:-pos1[this.currentSizeType.toLowerCase()]+this.minPaneSize,max:pos2[this.currentSizeType.toLowerCase()]-this.minPaneSize-this.resizerSize};this.resizeCfg[this.currentOffsetType]=pos[this.currentOffsetType];}},collapse(toCollapse,toUpdate,full){if(this.collapsible&&this.panes[toCollapse]&&this.panes[toUpdate]){let collapsing=!this.panes[toCollapse].collapsed,smaller=collapsing?toCollapse:toUpdate,bigger=collapsing?toUpdate:toCollapse,diff1=this.panes[smaller].savedDiff,diff2=this.panes[bigger].savedDiff;if(!full&&(this.panes[toCollapse].collapsed||this.panes[toUpdate].collapsed)){this.panes[smaller].addedSize='';this.panes[bigger].addedSize='';this.panes[smaller].tmpDiff=0;this.panes[bigger].tmpDiff=0;this.panes[smaller].collapsed=false;this.panes[smaller].pane.isCollapsed=false;this.panes[bigger].collapsed=false;this.panes[bigger].pane.isCollapsed=false;}
else if(full&&(this.panes[toUpdate].collapsed===collapsing)){this.panes[bigger].tmpDiff=diff1-this.resizerSize;this.panes[smaller].tmpDiff=0;if(this.panes[smaller].size){this.panes[bigger].addedSize=this.panes[smaller].size}
this.panes[bigger].collapsed=false;this.panes[smaller].collapsed=true;this.panes[bigger].pane.isCollapsed=false;this.panes[smaller].pane.isCollapsed=true;}
else{if(this.panes[toCollapse].size&&this.panes[toUpdate].size){this.panes[bigger].addedSize=this.panes[smaller].size;}
else{this.panes[bigger].addedSize='auto';}
this.panes[bigger].tmpDiff=diff1-this.resizerSize;this.panes[smaller].tmpDiff=0;this.panes[toCollapse].collapsed=collapsing;this.panes[toCollapse].pane.isCollapsed=collapsing;}
this.$nextTick(()=>{this.selfEmit();});}},hasExpander(paneIdx,resizerIdx){return false;let pane=this.panes[paneIdx],paneBefore=this.panes[paneIdx+1];if(this.collapsible&&(pane.collapsible!==false)&&paneBefore&&(paneBefore.collapsible!==false)&&(paneBefore.resizable!==false)){return true;}
return false;},expanderClass(paneIdx,resizerIdx){return'';}},mounted(){if(this.currentOrientation==='auto'){this.currentOrientation=this.getOrientation();this.$forceUpdate();}},updated(){},watch:{orientation(newVal,oldVal){bbn.fn.warning(newVal);if((newVal!==oldVal)&&(newVal!==this.currentOrientation)){this.currentOrientation=newVal==='auto'?this.getOrientation():newVal;}},currentOrientation(){this.init();},},});})(bbn);})(bbn);
((bbn)=>{let script=document.createElement('script');script.innerHTML=`<div :class="componentClass">
  <bbn-floater v-for="(it, idx) in items"
               :ref="'it' + it.id"
               :key="it.id"
               :focused="false"
               :container="$root.$el"
               :class="{
                  'bbn-notification-transition': positions[it.id] !== undefined,
                  'bbn-notification-closing': !!it.closing
               }"
               :top="isTop && (positions[it.id] !== undefined) ? positions[it.id] : undefined"
               :bottom="isTop || (positions[it.id] === undefined) ? undefined : positions[it.id]"
               :left="isLeft ? 0 : undefined"
               :right="isLeft ? undefined : 0"
               :title="false"
               :scrollable="true"
               @resize="_updatePositions"
               @hook.destroy="_updatePositions">
    <div :class="{
        'bbn-notification-content': true,
        'bbn-block': true,
        'bbn-unselectable': true,
        'bbn-white': !!it.type,
        'bbn-light': true,
        'bbn-m': true,
        'bbn-lpadded': true,
        'bbn-bg-green': it.type === 'success',
        'bbn-bg-orange': it.type === 'warning',
        'bbn-bg-red': it.type === 'error',
        'bbn-b': it.type === 'error',
        'bbn-bg-blue': it.content && (it.type === 'info')
    }">
      <span class="bbn-notification-icon bbn-iblock bbn-lg"
            v-if="it.icon">
        <i :class="[it.icon, it.type ? 'bbn-white' : 'bbn-black']"/>
      </span>
      <span v-if="it.content"
            class="bbn-iblock"
            v-html="it.content"/>
      <span v-else-if="it.type === 'success'"
            class="bbn-iblock"
            v-html="successMessage"/>
      <span v-else-if="it.type === 'warning'"
            class="bbn-iblock"
            v-html="warningMessage"/>
      <span v-else-if="it.type === 'error'"
            class="bbn-iblock"
            v-html="errorMessage"/>
      <div v-if="it.num > 1"
           class="bbn-iblock bbn-top-left bbn-hsmargin bbn-vxsmargin">
        <span class="bbn-badge bbn-small bbn-bg-red"
              v-text="it.num"/>
      </div>
      <div :class="{
          'bbn-notification-closer': true,
          'bbn-top-right': true,
          'bbn-vxsmargin': true,
          'bbn-hsmargin': true,
          'bbn-p': true,
          'bbn-white': !!it.type
      }"
          @click="close(it.id, true)">
          <i class="bbn-lg nf nf-fa-times"/>
      </div>
    </div>
  </bbn-floater>
</div>`;script.setAttribute('id','bbn-tpl-component-notification');script.setAttribute('type','text/x-template');document.body.insertAdjacentElement('beforeend',script);(bbn=>{"use strict";Vue.component('bbn-notification',{mixins:[bbn.vue.basicComponent],props:{delay:{type:Number,default:5000},position:{type:String,default:'bottom-right'},successMessage:{type:[String,Function],default:bbn._('Success')},warningMessage:{type:[String,Function],default:bbn._('Warning')},errorMessage:{type:[String,Function],default:bbn._('Error')},infoMessage:{type:[String,Function],default:bbn._('Info')},successIcon:{type:[String,Boolean],default:'nf nf-fa-check_square'},warningIcon:{type:[String,Boolean],default:'nf nf-fa-warning'},errorIcon:{type:[String,Boolean],default:'nf nf-fa-exclamation_circle'},infoIcon:{type:[String,Boolean],default:'nf nf-mdi-information'},source:{type:Array,default(){return[];}},},data(){let bits=this.position.split('-');let pos={v:{top:false,bottom:true},h:{left:false,right:true}};bbn.fn.each(bits,bit=>{bbn.fn.iterate(pos,(o,dir)=>{if(o[bit.toLowerCase()]!==undefined){bbn.fn.iterate(o,(b,k)=>{if(bit===k){pos[dir][k]=true;}
else{pos[dir][k]=false;}});}});});return{items:this.source,isTop:pos.v.top,isLeft:pos.h.left,positions:{}};},methods:{_sanitize(obj,type,timeout){if(!bbn.fn.isObject(obj)||(!obj.id)){if(typeof obj==='string'){obj={content:obj};}
else if(!obj){obj={};}
if(!obj.type){if(type){obj.type=type;}
else{}}
let id=(new Date()).getTime()+bbn.fn.randomString(10);obj.id=id;obj.num=1;if(!obj.content&&this[type+'Message']){obj.content=bbn.fn.isFunction(this[type+'Message'])?this[type+'Message'](obj):this[type+'Message']}
if(!obj.content){obj.content='';}
if(timeout&&!obj.delay){obj.delay=timeout>500?timeout:timeout*1000;}
else{obj.pinned=true;}
if(obj.icon!==false){if((obj.icon===undefined)&&obj.type&&this[obj.type+'Icon']){obj.icon=this[obj.type+'Icon'];}}}
return obj;},add(o){o=this._sanitize(o);let idx=bbn.fn.search(this.items,{content:o.content,type:o.type,icon:o.icon});if(idx>-1){o.num+=this.items[idx].num;this.items.splice(idx,1);}
this.items.push(o);this._updatePositions();if(o.delay){setTimeout(()=>{this.close(o.id);},o.delay);}},_updatePositions(){let p={};let pos=0;let ids=[];bbn.fn.each(this.items,a=>{let cp=this.getRef('it'+a.id);let s;if(cp){s=cp.$el.getBoundingClientRect().height;}
if(a.closing){p[a.id]=this.positions[a.id];}
else{p[a.id]=pos;if(s){pos+=s;}}
ids.push(a.id);});bbn.fn.iterate(bbn.fn.diffObj(this.positions,p),(a,k)=>{if(a.type==='updated'){this.positions[k]=a.newData;}
else if(a.type==='created'){this.positions[k]=a.data;}
else if(a.type==='deleted'){delete this.positions[k];}});this.$forceUpdate();},close(id,callCallback){let idx=bbn.fn.search(this.items,{id:id});if(idx>-1){if(callCallback&&this.items[idx].onClose&&bbn.fn.isFunction(this.items[idx].onClose)){this.items[idx].onClose(this.items[idx]);}
this.items.splice(idx,1);this._updatePositions();}},success(o,timeout){if(!timeout){timeout=this.delay;}
o=this._sanitize(o,'success',timeout);this.add(o);},error(o,timeout){o=this._sanitize(o,'error',timeout);this.add(o);},warning(o,timeout){o=this._sanitize(o,'warning',timeout);this.add(o);},show(o,type,timeout){o=this._sanitize(o,type,timeout);this.add(o);},info(o,timeout){o=this._sanitize(o,'info',timeout);this.add(o);},},beforeMount(){this._updatePositions();}});})(window.bbn);})(bbn);